remDr$navigate(stock_url)
stock_dates <- c()
remDr$getPageSource()[[1]]
html <- remDr$getPageSource()[[1]]
html %>%
read_html()
html %>%
read_html() %>%
html_nodes("tr")
trs <- html %>%
read_html() %>%
html_nodes("tr")
print(i)
for (i in trs) {
print(i)
}
for (i in trs) {
spans <- i %>%
html_nodes("span")
print(spans)
}
for (i in trs[2:]) {
spans <- i %>%
html_nodes("span")
}
for (i in trs) {
spans <- i %>%
html_nodes("span")
}
trs
trs[1]
trs[2]
trs[3]
trs[3:]
length(trs)
trs[3:17]
for (i in trs[3:length(trs)]) {
spans <- i %>%
html_nodes("span")
}
for (i in trs[3:length(trs)]) {
spans <- i %>%
html_nodes("span")
print(spans)
}
end_price <- c()
start_price <- c()
high_price <- c()
low_price <- c()
amount <- c()
print(spans)
for (i in trs[3:length(trs)]) {
spans <- i %>%
html_nodes("span")
for (j in spans) {
print(j)
}
}
for (i in trs[3:length(trs)]) {
spans <- i %>%
html_nodes("span")
for (j in spans) {
print(j %>%
html_text())
}
}
for (i in trs[3:length(trs)]) {
spans <- i %>%
html_nodes("span")
for (j in spans) {
print(j)
break
}
}
for (i in trs[3:length(trs)]) {
spans <- i %>%
html_nodes("span")
for (j in spans) {
print(j)
}
}
for (i in trs[3:length(trs)]) {
spans <- i %>%
html_nodes("span")
for (j in 1:7) {
print(span[j])
}
}
for (i in trs[3:length(trs)]) {
spans <- i %>%
html_nodes("span")
for (j in 1:7) {
print(spans[j])
}
}
for (i in trs[3:length(trs) - 1]) {
spans <- i %>%
html_nodes("span")
for (j in 1:7) {
print(spans[j])
}
}
for (i in trs[3:length(trs) - 2]) {
spans <- i %>%
html_nodes("span")
for (j in 1:7) {
print(spans[j])
}
}
trs <- html %>%
read_html() %>%
html_nodes("tr")[3:15]
trs <- html %>%
read_html() %>%
html_nodes("tr")
trs[3:15]
trs[3:15]
trs[3]
trs[3] %>%
html_nodes("span")
trs[3] %>%
html_nodes("span") %>%
html_text()
value <- trs[3] %>%
html_nodes("span") %>%
html_text()
value
value[1]
for (i in trs[3:length(trs) - 2]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
end_price
for (i in trs[5:length(trs) - 2]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
stock_dates <- c()
end_price <- c()
for (i in trs[5:length(trs) - 2]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
stock_dates <- c()
for (i in trs[5:9]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
for (i in trs[3:9]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates <- c()
for (i in trs[3:9]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
stock_dates <- c()
for (i in trs[3:7]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
for (i in trs[3:7, 11: length(trs) - 2]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates <- c()
for (i in trs[c(3:7, 11: length(trs) - 2)]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
stock_dates <- c()
for (i in trs[c(3:7, 13:(length(trs) - 2))]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
for (i in trs[c(3:7, 12:(length(trs) - 2))]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates <- c()
for (i in trs[c(3:7, 12:(length(trs) - 2))]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
stock_dates <- c()
for (i in trs[c(3:7, 11:(length(trs) - 2))]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
stock_dates
stock_dates <- c()
end_price <- c()
start_price <- c()
high_price <- c()
low_price <- c()
amount <- c()
for (pgNum in 1:232) {
stock_url <- str_c("https://finance.naver.com/item/sise_day.nhn?code=096770&page=", i)
remDr$navigate(stock_url)
html <- remDr$getPageSource()[[1]]
trs <- html %>%
read_html() %>%
html_nodes("tr")
for (i in trs[c(3:7, 11:(length(trs) - 2))]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
}
stock_dates <- c()
end_price <- c()
start_price <- c()
high_price <- c()
low_price <- c()
amount <- c()
for (pgNum in 1:232) {
stock_url <- str_c("https://finance.naver.com/item/sise_day.nhn?code=096770&page=", pgNum)
remDr$navigate(stock_url)
html <- remDr$getPageSource()[[1]]
trs <- html %>%
read_html() %>%
html_nodes("tr")
for (i in trs[c(3:7, 11:(length(trs) - 2))]) {
values <- i %>%
html_nodes("span") %>%
html_text()
stock_dates <- c(stock_dates, values[1])
end_price <- c(end_price, values[2])
start_price <- c(start_price, values[4])
high_price <- c(high_price, values[5])
low_price <- c(low_price, values[6])
amount <- c(amount, values[7])
}
}
stock_dates
length(stock_dates)
length(end_price)
length(start_price)
data.frame(stock_dates, end_price, start_price, high_price, low_price)
stock_data <- data.frame(stock_dates, end_price, start_price, high_price, low_price)
stock_df <- data.frame(stock_dates, end_price, start_price, high_price, low_price)
rm(stock_data)
dim(stock_df)
head(stock_df)
SK_news
head(SK_news)
head(stock_df)
str(stock_df)
stock_df
head(stock_df)
as.integer(123.500)
as.integer(123,500)
stock_df <- data.frame(stock_dates, end_price, start_price, high_price, low_price, amount)
dim(stock_df)
head(stock_df)
head(SK_news)
parse_string <- function(s) {
str_replace_all(s, "\n[\t]+<U+00A0>", "")
return (s)
}
SK_news[1, 2]
str_replace_all(SK_news[1, 2], "\n[\t]+<U\+00A0>", "")
str_replace_all(SK_news[1, 2], "\n[\t]+<U\\+00A0>", "")
str_replace_all(SK_news[1, 2], "^\n[\t]+<U\\+00A0>$", "")
str_replace_all(SK_news[1, 2], "[\t\n]", "")
str_1 <- str_replace_all(SK_news[1, 2], "[\t\n]", "")
str_replace(str_1, "[ ]", "")
str_1 <- str_replace_all(SK_news[1, 2], "[\t\n]", "")[2:]
str_1[2:]
str_1 <- str_replace_all(SK_news[1, 2], "[\t\n]", "")
str_1
trimws(str_1)
trimws(str_1, "l")
str_remove(str_1, "<U\\+00A0>")
str_remove(str_1, "<U+00A0>")
gsub(str_1, "<U\\+00A0>")
gsub(str_1, "<U\\+00A0>", "")
gsub("<U\\+00A0>", "", str_1)
parse_string <- function(s) {
str_replace_all(s, "[\t\n]", "")
return (s)
}
parse_string <- function(s) {
str_replace_all(s, "[\t\n]", "")
return (s)
}
apply(SK_news[, 2], parse_string)
apply(SK_news[, 2], 2, parse_string)
apply(SK_news[, 2], 1, parse_string)
apply(SK_news, 1, parse_string)
apply(SK_news, 2, parse_string)
parse_string <- function(s) {
s <- str_replace_all(s, "[\t\n]", "")
return (s)
}
apply(SK_news, 2, parse_string)
SK_news <- apply(SK_news, 2, parse_string)
SK_news
head(SK_news)
head(SK_news)
SK_news[1, 2]
parse_string <- function(s) {
s <- str_replace_all(s, "[\t\n]", "")
s <- str_replace(s, "^\\s+", "")
return (s)
}
SK_news <- apply(SK_news, 2, parse_string)
head(SK_news)
head(stock_df)
parse_date <- function(s) {
s <- str_replace_all(s, ".", "-")
return (s)
}
apply(stock_df, 2, parse_date)
parse_date <- function(s) {
s <- str_replace_all(s, "\\.", "-")
return (s)
}
apply(stock_df, 2, parse_date)
apply(stock_df[, 1], 2, parse_date)
apply(stock_df, 2, parse_date)
stock_df <- apply(stock_df, 2, parse_date)
parse_price <- function(s) {
s <- str_replace_all(s, ",", "")
s <- as.integer(s)
return (s)
}
apply(stock_df, 2, parse_price)
apply(stock_df[, 2:], 2, parse_price)
stock_df[, 2:]
stock_df[:, 2:]
dim(stock_df)
stock_df[:, 2:6]
stock_df[, 2:6]
apply(stock_df[, 2:6], 2, parse_price)
stock_prices <- apply(stock_df[, 2:6], 2, parse_price)
data.frame(stock_df[, 1], stock_prices)
stock_df <- data.frame(stock_df[, 1], stock_prices)
dim(stock_df)
str(stock_df)
stock_df
head(stcok_df)
head(stock_df)
head(SK_news)
col_names(stock_df)
colnames(stock_df)
colnames(stock_df)[1]
colnames(stock_df)[1] <- "dates"
stock_df
head(stock_df)
head(SK_news)
str(SK_news)
str(stock_df)
parse_date <- function(s) {
s <- str_replace_all(s, "\\.", "-")
s <- as.character(s)
return (s)
}
stock_df <- data.frame(stock_dates, end_price, start_price, high_price, low_price, amount)
stock_df <- apply(stock_df, 2, parse_date)
head(stock_df)
stock_prices <- apply(stock_df[, 2:6], 2, parse_price)
stock_df <- data.frame(stock_df[, 1], stock_prices)
dim(stock_df)
str(stock_df)
stock_df <- data.frame(stock_dates, end_price, start_price, high_price, low_price, amount)
stock_df
stock_df <- apply(stock_df, 2, parse_date)
stock_df
str(stock_df)
stock_prices <- apply(stock_df[, 2:6], 2, parse_price)
head(stock_prices)
stock_df <- data.frame(stock_df[, 1], stock_prices)
colnames(stock_df)[1] <- "dates"
str(stock_df)
as.character(stock_df[, 1])
stock_df[, 1] <- as.character(stock_df[, 1])
str(stock_df)
head(stock_df)
head(SK_news)
str(SK_news)
SK_news[, 1] <- as.character(SK_news[, 1])
head(stock_df)
str(SK_news)
head(SK_news)
data.frame(SK_news)
SK_news <- data.frame(SK_news)
head(SK_news)
str(SK_news)
str(stock_df)
SK_news[, 1] <- as.character(SK_news[, 1])
head(SK_news)
str(SK_news)
str(stock_df)
?merge
merge(SK_news, stock_df, all=T)
head(merge(SK_news, stock_df, all=T))
head(merge(SK_news, stock_df, by=dates , all=T))
head(merge(SK_news, stock_df, by="dates" , all=T))
sort(merge(SK_news, stock_df, by="dates" , all=T), by="dates")
sort(merge(SK_news, stock_df, by="dates" , all=T))
merge(SK_news, stock_df, by="dates" , all=T)
df <- merge(SK_news, stock_df, by="dates" , all=T)
setwd("C:/Users/kwon/Desktop/R/2020-ERICA-Construction-Programming-R/Team Project")
write.csv(df, file="SK이노베이션.csv", row.names=F)
